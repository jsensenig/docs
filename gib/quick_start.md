# Quick Start Guide

1. Grab the firmware https://gitlab.cern.ch/protoDUNE-SP-DAQ/timing-board-firmware/-/tree/gib_debug on the `gib_debug` branch. Requires a CERN computing account. The README in the root directory of the branch includes the directions to clone and build the firmware.
2. The control software can be found https://github.com/DUNE-DAQ/timing-board-software.git. Instructions to compile the software are included in the repository.
3. Assuming successful fimrware build and FPGA programming and compilation of
the software, the next step is configuration. Make sure the software
environment is set up with

```
source test/env.sh
```

Then make sure a connection is made to the board at IP address `192.168.200.16`,

```
sudo ifconfig <eth_adapter> up 192.168.200.1
ping 192.168.200.16
```

After the conection is made, reset and configure the GIB with 

```
python gib_debug.py
``` 

The script  will do the following:
1. Reset
    1. The firmware
    2. The components on the GIB
2. Configure 
    1. The GPS clock translator
    2. The clock generator (SI5395)
    3. Enable all SFP transmit
    4. Select recovered clock capture edge
3. Status
    1. Read temperature
    2. Read frequency counters

If you made it to this point the GIB should be ready to generate timing
protocol data which is syncronized to the 10MHz GPS clock. The firmware has
1 master block and 2 endpoint blocks which can be controlled by the standard
`pdtbutler` commands. The firmware

* Outputs clock/data in the timing protocol from all 6 SFPs, generated by the
  master block.
* Receives recovered clock and data from SFP 1 and 2.

The master block can be synchronized to the curent time and configured with 

```
pdtbutler mst GIB_PRIMARY timesync
pdtbutler mst GIB_PRIMARY part 0 configure
```

The endpoints 0 and 1 can be enabled with,

```
pdtbulter ep GIB_PRIMARY <endpoint #> enable
```

The master and endpoint's status can be monitored with

```
pdtbutler mst GIB_PRIMARY part 0 status
pdtbutler ep GIB_PRIMARY <endpoint #> status
```
